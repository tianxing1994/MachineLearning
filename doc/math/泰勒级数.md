## 泰勒级数



#### 罗尔中值定理

如果 R 上的函数 $f(x)$ 满足以下条件:
* (1) 在闭区间 [a,b] 上连续, 
* (2) 在开区间 (a,b) 内可导, 
* (3) $f(a)=f(b)$, 则至少存在一个 ξ∈(a,b), 使得 f'(ξ)=0. 
##### 证明: 
因为函数 $f(x)$ 在闭区间 [a, b] 上连续, 所以存在最大值与最小值, 分别用 M 和 m 表示, 分两种情况讨论: 
* 1. 若 M=m, 则函数 $f(x)$ 在闭区间 [a, b] 上必为常函数, 结论显然成立. 
* 2. 若 M>m, 则因为 $f(a)=f(b)$ 使得最大值 M 与最小值 m 至少有一个在 (a, b) 内某点 ξ 处取得, 从而 ξ 是 $f(x)$ 的极值点, 又条件 $f(x)$ 在开区间 (a, b) 内可导, 得: $f(x)$ 在 ξ 处取得极值, 由费马引理推知: $f'(ξ)=0$.
* 3. 另证: 若 M>m, 不妨设 $f(ξ)=M, ξ∈(a,b)$, 由可导条件知，f'(ξ+)<=0，f'(ξ-)>=0，又由极限存在定理知左右极限均为 0, 得证. 



#### 拉格朗日中值定理
如果函数 $f(x)$ 满足:
* (1) 在闭区间 [a,b] 上连续;
* (2) 在开区间 (a,b) 内可导; 那么在开区间 (a,b) 内至少有一点 ξ (a<ξ<b) 使等式 $f(b) - f(a) = f'(ξ) {\times} (b-a)$
##### 证明: 
辅助函数法：已知 $f(x)$ 在 [a, b] 上连续, 在开区间 (a, b) 内可导, 构造辅助函数 
$$g(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b - a}(x - a)$$ 
可得 $g(a) = g(b)$ 
又因为 $g(x)$ 在 [a, b] 上连续, 在开区间 (a, b) 内可导, 
所以根据罗尔定理可得必有一点  ξ∈(a,b), 使得 $g'(ξ)=0$.
由此可得 
$$g'(ξ)= f'(ξ) - \frac{f(b) - f(a)}{b - a} = 0$$
即: $f(b) - f(a) = f'(ξ)(b - a)$
定理证毕. 



#### 柯西中值定理
柯西 (Cauchy) 中值定理: 设函数 $f(x), g(x)$ 满足: 
* (1) 在闭区间 [a, b] 上连续;
* (2) 在开区间 (a, b) 内可导;
* (3) 对任意 x∈(a,b), $g'(x)≠0$, 
那么在 (a, b) 内至少有一点 ξ∈(a,b), 使得以式成立: 
$$\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(ξ)}{g'(ξ)} $$

* 在柯西中值定理中, 若取 g(x)=x 时, 则其结论形式和拉格朗日中值定理的结论形式相同. 因此, 拉格朗日中值定理为柯西中值定理的一个特例; 反之, 柯西中值定理可看作拉格朗日中值定理的推广. 
##### 证明: 

可构造辅助函数 
$$F(x) = [f(b) - f(a)] {\times} [g(x) - g(a)] - [g(b) - g(a)] {\times} [f(x) - f(a)]$$
$F(x)$ 在 [a, b] 上连续, 在 (a, b) 内可导, 且有 $F(a) = F(b) = 0$. 

由罗尔中值定理可知, 存在 ξ∈(a,b), 使得 $F'(x) = 0$, 即: 
$$[f(b) - f(a)] {\times} g'(ξ) - [g(b) - g(a)] {\times} f'(ξ) = 0$$
又 $g'(x) ≠ 0$, 所以有
$$\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(ξ)}{g'(ξ)} $$



### 泰勒级数
泰勒公式是将一个在 $x=x_{0}$ 处具有 n 阶导数的函数 $f(x)$ 利用关于 $(x-x_{0})$ 的 n 次多项式来逼近函数的方法. 
若函数 $f(x)$ 在包含 $x_{0}$ 的某个闭区间 [a, b] 上具有 n 阶导数, 且在开区间 (a, b) 上具有 (n+1) 阶导数, 则对闭区间 [a, b] 上任意一点 x, 成立下式: 
$$f(x) = \frac{f(x_{0})}{0!} + \frac{f'(x_{0})}{1!}(x - x_{0}) + \frac{f''(x_{0})}{2!}(x - x_{0})^{2} + ... + \frac{f^{(n)}(x_{0})}{n!}(x - x_{0})^{n} + R_{n}(x)$$
其中, $f(x)$ 具有 n+1 阶导数, 等号后的多项式称为函数 $f(x)$ 在 $x_{0}$ 处的泰勒展开式, 剩余的 $R_{n}(x)$ 是泰勒公式的余项, 是 $(x - x_{0})^{n}$ 的高阶无穷小. 

#### 公式推导
已知, 函数 $f(x)$ 在包含 $x_{0}$ 的某个闭区间 [a, b] 上具有 n 阶导数, 且在开区间 (a, b) 上具有 (n+1) 阶导数 则有: 
$$f(x) = f(x_{0}) + \int_{x_{0}}^{x} {f'(x)} \,{\rm d}x$$
$$f'(x) = f'(x_{0}) + \int_{x_{0}}^{x} {f''(x)} \,{\rm d}x$$
$$f''(x) = f''(x_{0}) + \int_{x_{0}}^{x} {f'''(x)} \,{\rm d}x$$
$$......$$
$$f^{(n)}(x) = f^{(n)}(x_{0}) + \int_{x_{0}}^{x} {f^{(n+1)}(x)} \,{\rm d}x$$
根据拉格朗日中值定理 即: $f(b) - f(a) = f'(ξ)(b - a)$ 有:

$$\begin{aligned}
f^{(n)}(x) - f^{(n)}(x_{0}) = \int_{x_{0}}^{x} {f^{(n+1)}(x)} \,{\rm d}x = f^{(n+1)}(ξ)(x - x_{0}) \\
f^{(n)}(x)= f^{(n)}(x_{0}) + f^{(n+1)}(ξ)(x - x_{0})
\end{aligned}$$

上式, 我们将 $f^{(n)}(x)= f^{(n)}(x_{0}) + f^{(n+1)}(ξ)(x - x_{0})$, 以及 $f^{(n-1)}(x)$  代入 $f^{(n-2)}(x)$ 再代入 $f^{(n-3)}(x)$ ...... 直到 $f(x)$. 
如下:

$$\begin{aligned}
f(x) =& f(x_{0}) + \int_{x_{0}}^{x} {f'(x)} \,{\rm d}x \\
     =& f(x_{0}) + \int_{x_{0}}^{x} {(f'(x_{0}) + \int_{x_{0}}^{x} {f''(x)} \,{\rm d}x)} \,{\rm d}x \\
     =& f(x_{0}) + \int_{x_{0}}^{x} {f'(x_{0})} \,{\rm d}x + \int_{x_{0}}^{x} \int_{x_{0}}^{x} {f''(x)} \,{\rm d}x \,{\rm d}x \\
     =& f(x_{0}) + f'(x_{0})(x - x_{0}) + \int_{x_{0}}^{x} \int_{x_{0}}^{x} {f''(x)} \,{\rm d}x \,{\rm d}x \\
     =& f(x_{0}) + f'(x_{0})(x - x_{0}) + \int_{x_{0}}^{x} \int_{x_{0}}^{x} {(f''(x_{0}) + \int_{x_{0}}^{x} {f'''(x)} \,{\rm d}x)} \,{\rm d}x \,{\rm d}x \\
     =& f(x_{0}) + f'(x_{0})(x - x_{0}) + \int_{x_{0}}^{x} \int_{x_{0}}^{x} {f''(x_{0})} \,{\rm d}x \,{\rm d}x + \int_{x_{0}}^{x} \int_{x_{0}}^{x} \int_{x_{0}}^{x} f'''(x) \,{\rm d}x \,{\rm d}x \,{\rm d}x \\
     =& f(x_{0}) + f'(x_{0})(x - x_{0}) + \int_{x_{0}}^{x} f''(x_{0})(x - x_{0}) \,{\rm d}x + \int_{x_{0}}^{x} \int_{x_{0}}^{x} \int_{x_{0}}^{x} f'''(x) \,{\rm d}x \,{\rm d}x \,{\rm d}x \\
     =& f(x_{0}) + f'(x_{0})(x - x_{0}) + \frac{f''(x_{0})^{2}}{2}(x - x_{0}) + \int_{x_{0}}^{x} \int_{x_{0}}^{x} \int_{x_{0}}^{x} f'''(x) \,{\rm d}x \,{\rm d}x \,{\rm d}x \\
     =& \qquad \text{以此类推} \\
     =&\frac{f(x_{0})}{0!} + \frac{f'(x_{0})}{1!}(x - x_{0}) + \frac{f''(x_{0})}{2!}(x - x_{0})^{2} + \frac{f'''(x_{0})}{3!}(x - x_{0})^{3} + ... + \frac{f^{(n-1)}(x_{0})}{(n-1)!}(x - x_{0})^{(n-1)} + (\int_{x_{0}}^{x})^{n} f^{(n)}(x) (\,{\rm d}x)^{n} \\
     =& \frac{f(x_{0})}{0!} + \frac{f'(x_{0})}{1!}(x - x_{0}) + \frac{f''(x_{0})}{2!}(x - x_{0})^{2} + \frac{f'''(x_{0})}{3!}(x - x_{0})^{3} + ... + \frac{f^{(n-1)}(x_{0})}{(n-1)!}(x - x_{0})^{(n-1)} + (\int_{x_{0}}^{x})^{n} (f^{(n)}(x_{0}) + f^{(n+1)}(ξ)(x - x_{0})) (\,{\rm d}x)^{n} \\
     =&\frac{f(x_{0})}{0!} + \frac{f'(x_{0})}{1!}(x - x_{0}) + \frac{f''(x_{0})}{2!}(x - x_{0})^{2} + \frac{f'''(x_{0})}{3!}(x - x_{0})^{3} + ... + \frac{f^{(n-1)}(x_{0})}{(n-1)!}(x - x_{0})^{(n-1)} + \frac{f^{(n)}(x_{0})}{n!}(x - x_{0})^{(n)} + (\int_{x_{0}}^{x})^{n} f^{(n+1)}(ξ)(x - x_{0}) (\,{\rm d}x)^{n} \\
     =& \frac{f(x_{0})}{0!} + \frac{f'(x_{0})}{1!}(x - x_{0}) + \frac{f''(x_{0})}{2!}(x - x_{0})^{2} + \frac{f'''(x_{0})}{3!}(x - x_{0})^{3} + ... + \frac{f^{(n-1)}(x_{0})}{(n-1)!}(x - x_{0})^{(n-1)} + \frac{f^{(n)}(x_{0})}{n!}(x - x_{0})^{(n)} + \frac{f^{(n+1)}(ξ)}{(n+1)!}(x - x_{0})^{(n+1)} \\
     =&  \frac{f(x_{0})}{0!} + \frac{f'(x_{0})}{1!}(x - x_{0}) + \frac{f''(x_{0})}{2!}(x - x_{0})^{2} + ... + \frac{f^{(n)}(x_{0})}{n!}(x - x_{0})^{n} + R_{n}(x)
\end{aligned}$$

其中: 
$$R_{n}(x) = \frac{f^{(n+1)}(ξ)}{(n+1)!}(x - x_{0})^{(n+1)}$$
ξ∈(a,b), 此为拉格朗日型余项的 n 阶麦克劳林公式. 

得证. 



#### 麦克劳林公式
麦克劳林公式是泰勒公式 (在 $x_{0} = 0, 记 ξ = θx (0<θ<1)$) 的一种特殊形式. 
在不需要余项的精确表达式时, n 阶泰勒公式也可以写成: 
$$f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^{2} + ... + \frac{f^{(n)}(0)}{n!}x^{n} + \frac{f^{(n+1)}(θx)}{(n+1)!}x^{(n+1)} (0<θ<1)$$
由此得近公式: 
$$f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^{2} + ... + \frac{f^{(n)}(0)}{n!}x^{n}$$
误差估计式变为: 
$$|R_{n}(x)| ≤ \frac{M}{(n+1)!}|x|^{(n+1)}, \lim\limits_{x\rightarrow0}\frac{R_{n}(x)}{x^{n}} = 0$$
在麦克劳林公式中, 误差 $|R_{n}(x)|$ 是当 $x\rightarrow0$ 时比 $x^{n}$ 高阶的无穷小.

##### 常用公式

$$\begin{aligned}
&e^{x} = 1 + x + \frac{x^{2}}{2!} + ... + \frac{x^{n}}{n!} + o(x^{n}) \\
&\sin x = x - \frac{x^{3}}{3!} + \frac{x^{5}}{5!} - \frac{x^{7}}{7!} + ... + (-1)^{n}\frac{x^{2n+1}}{(2n+1)!} + o(x^{2n+2}) \\
&\cos x = 1 - \frac{x^{2}}{2!} + \frac{x^{4}}{4!} -  \frac{x^{6}}{6!} + ... + (-1)^{n}\frac{x^{2n}}{(2n)!} + o(x^{2n+1}) \\
&ln(1+x) = x - \frac{x^{2}}{2} + \frac{x^{3}}{3} - \frac{x^{4}}{4} + ... + (-1)^{n-1}\frac{x^{n}}{n} + o(x^{n}) \\
&(1+x)^{\alpha} = 1 + \alpha x + \frac{\alpha(\alpha -1)}{2!}x^{2} + ... + \frac{\alpha(\alpha -1) ... (\alpha - n + 1)}{n!}x^{n} + o(x^{n})
\end{aligned}$$

#### 欧拉公式
$$e^{ix} = \cos x + i \sin x$$

##### 公式推导
由麦克劳林公式知:

$$\begin{aligned}
&e^{x} = 1 + x + \frac{x^{2}}{2!} + ... + \frac{x^{n}}{n!} + o(x^{n}) \\
&\sin x = x - \frac{x^{3}}{3!} + \frac{x^{5}}{5!} - \frac{x^{7}}{7!} + ... + (-1)^{n}\frac{x^{2n+1}}{(2n+1)!} + o(x^{2n+2}) \\
&\cos x = 1 - \frac{x^{2}}{2!} + \frac{x^{4}}{4!} -  \frac{x^{6}}{6!} + ... + (-1)^{n}\frac{x^{2n}}{(2n)!} + o(x^{2n+1}) \\
\end{aligned}$$

求 $e^{ix}$ (忽略余项):

$$\begin{aligned}
e^{x} =& 1 + ix + \frac{(ix)^{2}}{2!} + \frac{(ix)^{3}}{3!} + \frac{(ix)^{4}}{4!} + \frac{(ix)^{5}}{5!} + ... + \frac{(ix)^{4n}}{(4n)!} + \frac{(ix)^{4n+1}}{(4n+1)!} + \frac{(ix)^{4n+2}}{(4n+2)!} + \frac{(ix)^{4n+3}}{(4n+3)!} + \frac{(ix)^{4n+4}}{(4n+4)!} \\
=& 1 + ix + i^{2}\frac{x^{2}}{2!} + i^{3}\frac{x^{3}}{3!} + i^{4}\frac{x^{4}}{4!} + i^{5}\frac{x^{5}}{5!} + ... + i^{4n}\frac{x^{4n}}{(4n)!} + i^{4n+1}\frac{x^{4n+1}}{(4n+1)!} + i^{4n+2}\frac{x^{4n+2}}{(4n+2)!} + i^{4n+3}\frac{x^{4n+3}}{(4n+3)!} +  i^{4n+4}\frac{x^{4n+4}}{(4n+4)!}\\
=& 1 + ix + (-1)\frac{x^{2}}{2!} + (-1) \times i \frac{x^{3}}{3!} + (-1)^{2}\frac{x^{4}}{4!} + (-1)^{2} \times i \frac{x^{5}}{5!} + ... + (-1)^{2n}\frac{x^{4n}}{(4n)!} + (-1)^{2n} \times i \frac{x^{4n+1}}{(4n+1)!} + (-1)^{2n+1}\frac{x^{4n+2}}{(4n+2)!} + (-1)^{2n+1} \times i \frac{x^{4n+3}}{(4n+3)!} + (-1)^{2n+2} \frac{x^{4n+4}}{(4n+4)!}\\
=& 1 + ix - \frac{x^{2}}{2!} - i \frac{x^{3}}{3!} + \frac{x^{4}}{4!} + i \frac{x^{5}}{5!} + ...  + \frac{x^{4n}}{(4n)!} + i \frac{x^{4n+1}}{(4n+1)!} - \frac{x^{4n+2}}{(4n+2)!} -  i \frac{x^{4n+3}}{(4n+3)!} + \frac{x^{4n+4}}{(4n+4)!} \\
& \text{将含有 i 的项和不含有 i 的项分开. } \\
=& 1 - \frac{x^{2}}{2!} + \frac{x^{4}}{4!} -  \frac{x^{6}}{6!} + ... + (-1)^{2n}\frac{x^{4n}}{(4n)!} + (-1)^{2n+1}\frac{x^{4n+2}}{(4n+2)!} + (-1)^{2n+2}\frac{x^{4n+4}}{(4n+4)!} + i \times (x - \frac{x^{3}}{3!} + \frac{x^{5}}{5!} - \frac{x^{7}}{7!} + ... + (-1)^{2n}\frac{x^{4n+1}}{(4n+1)!} + (-1)^{2n+1}\frac{x^{4n+3}}{(4n+3)!} ) \\
=& \cos x + i \times \sin x
\end{aligned}$$

证毕.


#### 二元函数的泰勒展开
设函数 $z = f(x, y)$, 则全微分 dz 可以表示为:

$$\begin{aligned}
z_{1} - z_{0} &= f(x_{1}, y_{1}) - f(x_{0}, y_{0}) \\
dz &= \int_{x_{0}}^{x_{1}}{f_{x}^{'}(x, y_{0})dx} + \int_{y0}^{y_{1}}{f_{y}^{'}(x_{1}, y)dy}
\end{aligned}$$

其中: 
* $f_{x}^{'}(x, y_{0})$ 是函数 $f(x, y)$ 在 $y=y_{0}$ 处关于 x 的偏导数. 
* $f_{y}^{'}(x_{1}, y)$ 是函数 $f(x, y)$ 在 $x=x_{1}$ 处关于 y 的偏导数. 

根据一元函数的泰勒展开, $f(x, y)$ 在 $x=x_{1}$ 处关于 $y$ 的偏导数 $f_{y}^{'}(x1, y)$ 可以展开如下:

$$\begin{aligned}
f_{y}^{'}(x_{1}, y) = f_{y}^{'}(x_{0}, y) + \int_{x_{0}}^{x_{1}}{f_{yx}^{''}(x, y)dx}
\end{aligned}$$

其中: 
* $f_{y}^{'}(x_{0}, y)$ 表示 $f(x, y)$ 在 $x=x_{0}$ 处关于 $y$ 的偏导数. 
* $\int_{x_{0}}^{x_{1}}{f_{yx}^{''}(x, y)dx}$ 表示 $f(x, y)$ 关于 y 的偏导数再关于 x 的偏导数的二阶导数积分. 
将上式代入 dz 等式, 所以 dz 可以表示为:

$$\begin{aligned}
dz &= \int_{x_{0}}^{x_{1}}{f_{x}^{'}(x, y_{0})dx} + \int_{y0}^{y_{1}}{f_{y}^{'}(x_{1}, y)dy} \\
&= \int_{x_{0}}^{x_{1}}{f_{x}^{'}(x, y_{0})dx} + \int_{y_{0}}^{y_{1}}{f_{y}^{'}(x_{0}, y)dy} + \int_{y_{0}}^{y_{1}} \int_{x_{0}}^{x_{1}}f_{yx}^{''}{(x, y)}dxdy
\end{aligned}$$

有:

$$\begin{aligned}
f(x_{1}, y_{1}) &= f(x_{0}, y_{0}) + \int_{x_{0}}^{x_{1}}{f_{x}^{'}(x, y_{0})dx} + \int_{y_{0}}^{y_{1}}{f_{y}^{'}(x_{0}, y)dy} + \int_{y_{0}}^{y_{1}} \int_{x_{0}}^{x_{1}}f_{yx}^{''}{(x, y)}dxdy
\end{aligned}$$

其中: 
* $f_{x}^{'}(x, y_{0})$ 是关于 x 的一元函数, 我们只取其泰勒展开的前两项 $f_{x}^{'}(x_{0}, y_{0}) + \int_{x_{0}}^{x_{1}}{f_{xx}^{''}(x, y_{0})}dx$. 
* $f_{x}^{'}(x_{0}, y)$ 是关于 y 的一元函数, 我们只取其泰勒展开的前两项 $f_{y}^{'}(x_{0}, y_{0}) + \int_{y_{0}}^{y_{1}}{f_{yy}^{''}(x_{0}, y)}dy$. 
代入上式, 有:

$$\begin{aligned}
f(x_{1}, y_{1}) &= f(x_{0}, y_{0}) + \int_{x_{0}}^{x_{1}}{f_{x}^{'}(x_{0}, y_{0})dx} + \int_{y_{0}}^{y_{1}}{f_{y}^{'}(x_{0}, y_{0})dy} + \int_{x_{0}}^{x_{1}}\int_{x_{0}}^{x_{1}}{f_{xx}^{''}(x, y_{0})}dxdx + \int_{y_{0}}^{y_{1}}\int_{y_{0}}^{y_{1}}{f_{yy}^{''}(x_{0}, y)}dydy + \int_{y_{0}}^{y_{1}} \int_{x_{0}}^{x_{1}}f_{yx}^{''}{(x, y)}dxdy
\end{aligned}$$

上式, 我们不再作深入的泰勒展开, 则有:

$$\begin{aligned}
f(x_{1}, y_{1}) &= f(x_{0}, y_{0}) + \int_{x_{0}}^{x_{1}}{f_{x}^{'}(x_{0}, y_{0})dx} + \int_{y_{0}}^{y_{1}}{f_{y}^{'}(x_{0}, y_{0})dy} + \int_{x_{0}}^{x_{1}}\int_{x_{0}}^{x_{1}}{f_{xx}^{''}(x_{0}, y_{0})}dxdx + \int_{y_{0}}^{y_{1}}\int_{y_{0}}^{y_{1}}{f_{yy}^{''}(x_{0}, y_{0})}dydy + \int_{y_{0}}^{y_{1}} \int_{x_{0}}^{x_{1}}f_{yx}^{''}{(x_{0}, y_{0})}dxdy \\
&= f(x_{0}, y_{0}) + (x_{1} - x_{0})f_{x}^{'}{(x_{0}, y_{0})} + (y_{1} - y_{0})f_{y}^{'}(x_{0}, y_{0}) + \frac{(x_{1}-x_{0})^{2}}{2}f_{xx}^{''}(x_{0}, y_{0}) + \frac{(y_{1}-y_{0})^{2}}{2}f_{yy}^{''}(x_{0}, y_{0}) + (y_{1}-y_{0})(x_{1}-x_{0})f_{yx}^{''}{(x_{0}, y_{0})}
\end{aligned}$$

至此, 得出二元函数的二阶泰勒展开, 其矩阵表示形式为:

$$\begin{aligned}f(x, y) = f(x_{0}, y_{0}) + \left[\begin{matrix}f_{x}^{'}(x_{0}, y_{0}) \\f_{y}^{'}(x_{0}, y_{0}) \\\end{matrix}\right]\cdot\left[\begin{matrix}(x - x_{0}) \\(y - y_{0}) \\\end{matrix}\right]\frac{1}{2}\left[\begin{matrix}f_{xx}^{''}(x_{0}, y_{0}) &f_{xy}^{''}{(x_{0}, y_{0})} \\f_{xy}^{''}{(x_{0}, y_{0})} &f_{yy}^{''}(x_{0}, y_{0}) \\\end{matrix}\right]\cdot\left[\begin{matrix}(x - x_{0}) \\(y - y_{0}) \\\end{matrix}\right]\end{aligned}$$

其中, 二阶导数的部分就是二元函数的 **Hessian 矩阵**. 

